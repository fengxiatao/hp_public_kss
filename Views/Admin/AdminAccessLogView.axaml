<UserControl xmlns="https://github.com/avaloniaui"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 xmlns:converters="clr-namespace:FaceLocker.Converters"
			 xmlns:vm="clr-namespace:FaceLocker.ViewModels"
			 mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="700"
			 x:Class="FaceLocker.Views.AdminAccessLogView"
			 x:DataType="vm:AdminAccessLogViewModel">

	<UserControl.Styles>
		<Style Selector="TextBlock.column-header">
			<Setter Property="FontWeight" Value="Bold"/>
			<Setter Property="Foreground" Value="#2c3e50"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="VerticalAlignment" Value="Center"/>
		</Style>

		<Style Selector="TextBlock.column-data">
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="VerticalAlignment" Value="Center"/>
		</Style>

		<Style Selector="Border.data-row">
			<Setter Property="Background" Value="White"/>
			<Setter Property="BorderBrush" Value="#ecf0f1"/>
			<Setter Property="BorderThickness" Value="0,0,0,1"/>
		</Style>

		<Style Selector="Border.data-row:pointerover">
			<Setter Property="Background" Value="#f8f9fa"/>
		</Style>

		<Style Selector="Border.result-badge">
			<Setter Property="Padding" Value="6,2"/>
			<Setter Property="CornerRadius" Value="4"/>
			<Setter Property="VerticalAlignment" Value="Center"/>
			<Setter Property="HorizontalAlignment" Value="Center"/>
		</Style>

		<Style Selector="TextBox.search-box">
			<Setter Property="Background" Value="White"/>
			<Setter Property="BorderBrush" Value="#bdc3c7"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Padding" Value="10,8"/>
			<Setter Property="FontSize" Value="14"/>
		</Style>

		<Style Selector="DatePicker.filter-date">
			<Setter Property="Background" Value="White"/>
			<Setter Property="BorderBrush" Value="#bdc3c7"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Padding" Value="10,8"/>
			<Setter Property="FontSize" Value="14"/>
		</Style>
	</UserControl.Styles>

	<Grid Margin="10">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<!-- 搜索和过滤区域 -->
		<Border Grid.Row="0" Background="#ecf0f1" Padding="15" Margin="0,0,0,10" CornerRadius="5">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
				</Grid.RowDefinitions>

				<!-- 标签行 -->
				<StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="10" Margin="0,0,0,5">
					<TextBlock Text="柜子名称" FontSize="11" Foreground="#7f8c8d" Width="200"/>
					<TextBlock Text="开始日期" FontSize="11" Foreground="#7f8c8d" Width="240"/>
					<TextBlock Text="" FontSize="11" Foreground="#7f8c8d" Width="30"/>
					<TextBlock Text="结束日期" FontSize="11" Foreground="#7f8c8d" Width="240"/>
					<TextBlock Text="操作" FontSize="11" Foreground="#7f8c8d" Width="270"/>
				</StackPanel>

				<!-- 控件行 - 保持底部对齐 -->
				<StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
					<!-- 柜子名称过滤 -->
					<TextBox Classes="search-box"
							 Width="200"
							 Text="{Binding LockerFilter, Mode=TwoWay}"
							 VerticalAlignment="Center">
						<TextBox.Watermark>
							柜子名称...
						</TextBox.Watermark>
					</TextBox>

					<!-- 开始日期 -->
					<DatePicker Name="StartDatePicker" Classes="filter-date"
								Width="240"
								SelectedDate="{Binding StartDate, Mode=TwoWay}"
								YearFormat="yyyy"
								MonthFormat="MM"
								DayFormat="dd"
								VerticalAlignment="Center"/>

					<TextBlock Text="至"
							   VerticalAlignment="Center"
							   FontSize="14"
							   Foreground="#2c3e50"
							   Margin="0,0,0,5"/>

					<!-- 结束日期 -->
					<DatePicker Name="EndDatePicker" Classes="filter-date"
								Width="240"
								SelectedDate="{Binding EndDate, Mode=TwoWay}"
								YearFormat="yyyy"
								MonthFormat="MM"
								DayFormat="dd"
								VerticalAlignment="Center"/>

					<!-- 操作按钮 -->
					<StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
						<Button Content="搜索"
								Padding="15,8"
								Background="#3498db"
								Foreground="White"
								BorderThickness="0"
								CornerRadius="4"
								FontSize="14"
								Cursor="Hand"
								Command="{Binding SearchCommand}"/>

						<Button Content="重置"
								Padding="15,8"
								Background="#95a5a6"
								Foreground="White"
								BorderThickness="0"
								CornerRadius="4"
								FontSize="14"
								Cursor="Hand"
								Command="{Binding ResetSearchCommand}"/>

						<Button Content="刷新"
								Padding="15,8"
								Background="#2ecc71"
								Foreground="White"
								BorderThickness="0"
								CornerRadius="4"
								FontSize="14"
								Cursor="Hand"
								Command="{Binding RefreshCommand}"/>
					</StackPanel>
				</StackPanel>
			</Grid>
		</Border>

		<!-- 表格区域 -->
		<Border Grid.Row="1" Background="White" CornerRadius="5" BorderBrush="#bdc3c7" BorderThickness="1">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="*"/>
				</Grid.RowDefinitions>

				<!-- 表头 -->
				<Border Grid.Row="0" Background="#ecf0f1" BorderBrush="#bdc3c7" BorderThickness="0,0,0,1">
					<Grid Margin="15,12">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="60"/>
							<ColumnDefinition Width="120"/>
							<ColumnDefinition Width="150"/>
							<ColumnDefinition Width="120"/>
							<ColumnDefinition Width="100"/>
							<ColumnDefinition Width="150"/>
							<ColumnDefinition Width="120"/>
							<ColumnDefinition Width="200"/>
						</Grid.ColumnDefinitions>

						<TextBlock Grid.Column="0" Text="序号" Classes="column-header" HorizontalAlignment="Center"/>
						<TextBlock Grid.Column="1" Text="用户姓名" Classes="column-header"/>
						<TextBlock Grid.Column="2" Text="柜子名称" Classes="column-header"/>
						<TextBlock Grid.Column="3" Text="操作类型" Classes="column-header"/>
						<TextBlock Grid.Column="4" Text="操作结果" Classes="column-header"/>
						<TextBlock Grid.Column="5" Text="操作时间" Classes="column-header"/>
						<TextBlock Grid.Column="6" Text="详细信息" Classes="column-header"/>
						<TextBlock Grid.Column="7" Text="操作摘要" Classes="column-header"/>
					</Grid>
				</Border>

				<!-- 表格内容区域 -->
				<Grid Grid.Row="1">
					<!-- 数据行 -->
					<ScrollViewer VerticalScrollBarVisibility="Auto"
								  IsVisible="{Binding HasData}">
						<ItemsControl x:Name="AccessLogsItemsControl" Margin="0">
							<ItemsControl.ItemTemplate>
								<DataTemplate x:DataType="vm:AccessLogItem">
									<Border Classes="data-row">
										<Grid Margin="15,10">
											<Grid.ColumnDefinitions>
												<ColumnDefinition Width="60"/>
												<ColumnDefinition Width="120"/>
												<ColumnDefinition Width="150"/>
												<ColumnDefinition Width="120"/>
												<ColumnDefinition Width="100"/>
												<ColumnDefinition Width="150"/>
												<ColumnDefinition Width="120"/>
												<ColumnDefinition Width="200"/>
											</Grid.ColumnDefinitions>

											<!-- 序号 -->
											<TextBlock Grid.Column="0"
													   Text="{Binding RowIndex}"
													   Classes="column-data"
													   HorizontalAlignment="Center"/>

											<!-- 用户姓名 -->
											<TextBlock Grid.Column="1"
													   Text="{Binding UserName}"
													   Classes="column-data"/>

											<!-- 柜子名称 -->
											<TextBlock Grid.Column="2"
													   Text="{Binding LockerName}"
													   Classes="column-data"/>

											<!-- 操作类型 -->
											<StackPanel Grid.Column="3"
														Orientation="Horizontal"
														VerticalAlignment="Center"
														Spacing="5">
												<TextBlock Text="{Binding ActionIcon}"
														   FontSize="16"/>
												<TextBlock Text="{Binding ActionType}"
														   Classes="column-data"/>
											</StackPanel>

											<!-- 操作结果 -->
											<Border Grid.Column="4"
													Classes="result-badge"
													Background="{Binding ResultBackgroundColor}">
												<TextBlock Text="{Binding Result}"
														   Foreground="{Binding ResultForegroundColor}"
														   FontSize="12"
														   FontWeight="SemiBold"/>
											</Border>

											<!-- 操作时间 -->
											<TextBlock Grid.Column="5"
													   Text="{Binding Timestamp}"
													   Classes="column-data"/>

											<!-- 详细信息 -->
											<TextBlock Grid.Column="6"
													   Text="{Binding Details}"
													   Classes="column-data"
													   TextTrimming="CharacterEllipsis">
												<ToolTip.Tip>
													<TextBlock Text="{Binding Details}"
															   TextWrapping="Wrap"
															   MaxWidth="400"/>
												</ToolTip.Tip>
											</TextBlock>

											<!-- 操作摘要 -->
											<TextBlock Grid.Column="7"
													   Text="{Binding Summary}"
													   Classes="column-data"
													   TextTrimming="CharacterEllipsis">
												<ToolTip.Tip>
													<TextBlock Text="{Binding Summary}"
															   TextWrapping="Wrap"
															   MaxWidth="400"/>
												</ToolTip.Tip>
											</TextBlock>
										</Grid>
									</Border>
								</DataTemplate>
							</ItemsControl.ItemTemplate>
						</ItemsControl>
					</ScrollViewer>

					<!-- 加载指示器 -->
					<Border Background="#80ffffff"
							IsVisible="{Binding IsLoading}"
							VerticalAlignment="Center"
							HorizontalAlignment="Center">
						<StackPanel Orientation="Horizontal" Spacing="10" Margin="20">
							<ProgressBar Width="30" Height="30" IsIndeterminate="True"/>
							<TextBlock Text="加载中..." FontSize="14" Foreground="#2c3e50" VerticalAlignment="Center"/>
						</StackPanel>
					</Border>

					<!-- 无数据提示 -->
					<Border Background="Transparent"
							IsVisible="{Binding ShowNoDataMessage}"
							VerticalAlignment="Center"
							HorizontalAlignment="Center">
						<StackPanel Orientation="Vertical" Spacing="10" HorizontalAlignment="Center">
							<TextBlock Text="暂无访问日志数据"
									   FontSize="16"
									   Foreground="#7f8c8d"
									   VerticalAlignment="Center"/>
							<Button Content="重新加载"
									Padding="15,8"
									Background="#3498db"
									Foreground="White"
									BorderThickness="0"
									CornerRadius="4"
									FontSize="14"
									Cursor="Hand"
									Command="{Binding RefreshCommand}"/>
						</StackPanel>
					</Border>
				</Grid>
			</Grid>
		</Border>

		<!-- 分页控制区域 -->
		<Border Grid.Row="2"
				Background="#ecf0f1"
				Padding="15"
				Margin="0,10,0,0"
				CornerRadius="5"
				BorderBrush="#bdc3c7"
				BorderThickness="1">
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition Width="Auto"/>
				</Grid.ColumnDefinitions>

				<!-- 总记录数 -->
				<TextBlock Grid.Column="0"
						   VerticalAlignment="Center"
						   FontSize="14"
						   Foreground="#2c3e50">
					<Run Text="共"/>
					<Run Text="{Binding TotalCount}"/>
					<Run Text="条记录"/>
				</TextBlock>

				<!-- 每页显示数量 -->
				<StackPanel Grid.Column="1"
							Orientation="Horizontal"
							VerticalAlignment="Center"
							Spacing="10"
							Margin="0,0,20,0">
					<TextBlock Text="每页显示:"
							   VerticalAlignment="Center"
							   FontSize="14"
							   Foreground="#2c3e50"/>
					<ComboBox Name="PageSizeComboBox" Width="80"
							  FontSize="14"
							  Background="White"
							  BorderBrush="#bdc3c7"
							  ItemsSource="{Binding PageSizes}"
							  SelectedItem="{Binding PageSize, Mode=TwoWay}"/>
				</StackPanel>

				<!-- 分页按钮 -->
				<StackPanel Grid.Column="2"
							Orientation="Horizontal"
							Spacing="5">
					<Button Name="FirstPageButton" Content="首页"
							Padding="12,6"
							FontSize="14"
							Background="#3498db"
							Foreground="White"
							BorderThickness="0"
							CornerRadius="3"
							Cursor="Hand"
							Command="{Binding FirstPageCommand}"
							IsEnabled="{Binding CanGoToFirstPage}"/>

					<Button Name="PreviousPageButton" Content="上一页"
							Padding="12,6"
							FontSize="14"
							Background="#3498db"
							Foreground="White"
							BorderThickness="0"
							CornerRadius="3"
							Cursor="Hand"
							Command="{Binding PreviousPageCommand}"
							IsEnabled="{Binding CanGoToPreviousPage}"/>

					<TextBlock VerticalAlignment="Center"
							   Margin="10,0"
							   FontSize="14"
							   Foreground="#2c3e50">
						<Run Text="第"/>
						<Run Text="{Binding CurrentPage}"/>
						<Run Text="页"/>
					</TextBlock>

					<TextBlock VerticalAlignment="Center"
							   Margin="0,0,10,0"
							   FontSize="14"
							   Foreground="#2c3e50">
						<Run Text="共"/>
						<Run Text="{Binding TotalPages}"/>
						<Run Text="页"/>
					</TextBlock>

					<Button Name="NextPageButton" Content="下一页"
							Padding="12,6"
							FontSize="14"
							Background="#3498db"
							Foreground="White"
							BorderThickness="0"
							CornerRadius="3"
							Cursor="Hand"
							Command="{Binding NextPageCommand}"
							IsEnabled="{Binding CanGoToNextPage}"/>

					<Button Name="LastPageButton" Content="末页"
							Padding="12,6"
							FontSize="14"
							Background="#3498db"
							Foreground="White"
							BorderThickness="0"
							CornerRadius="3"
							Cursor="Hand"
							Command="{Binding LastPageCommand}"
							IsEnabled="{Binding CanGoToLastPage}"/>
				</StackPanel>
			</Grid>
		</Border>
	</Grid>
</UserControl>
